SELECT shohin_mei, shohin_bunrui, hanbai_tanka,
	RANK () OVER (PARTITION BY shohin_bunrui ORDER BY hanbai_tanka) AS ranking
FROM Shohin;


SELECT shohin_mei, shohin_bunrui, hanbai_tanka,
	RANK () OVER (ORDER BY hanbai_tanka) AS ranking
FROM Shohin;

SELECT shohin_mei, shohin_bunrui, hanbai_tanka,
	RANK () OVER (ORDER BY hanbai_tanka)  AS ranking,
	DENSE_RANK () OVER (ORDER BY hanbai_tanka) AS dense_ranking,
	ROW_NUMBER () OVER (ORDER BY hanbai_tanka) AS row_num
FROM Shohin;

8-4
SELECT shohin_id, shohin_mei, hanbai_tanka,
	SUM (hanbai_tanka) OVER (ORDER BY shohin_id) AS current_sum
FROM Shohin;

8-5
SELECT shohin_id, shohin_mei, hanbai_tanka,
	AVG (hanbai_tanka) OVER (ORDER BY shohin_id) AS current_avg
FROM Shohin;


8-6
SELECT shohin_id, shohin_mei, hanbai_tanka,
	AVG (hanbai_tanka) OVER (ORDER BY shohin_id ROWS 2 PRECEDING)
AS moving_avg
FROM Shohin;

8-7
SELECT shohin_id, shohin_mei, hanbai_tanka,
	AVG (hanbai_tanka) OVER (ORDER BY shohin_id ROWS BETWEEN 1 PRECEDING AND
1 FOLLOWING) AS moving_avg
FROM Shohin;

8-9
SELECT shohin_mei, shohin_bunrui, hanbai_tanka,
	RANK () OVER (ORDER BY hanbai_tanka) AS ranking
FROM Shohin
ORDER BY ranking;

