結合（列を増やす）

SELECT TS.tenpo_id, TS.tenpo_mei, TS.shohin_id, S.shohin_mei,
S.hanbai_tanka
	FROM TenpoShohin AS TS INNER JOIN Shohin AS S 
	ON TS.shohin_id = S.shohin_id;


SELECT TS.tenpo_id, TS.tenpo_mei, TS.shohin_id, S.shohin_mei,
S.hanbai_tanka
	FROM TenpoShohin AS TS INNER JOIN Shohin AS S 
	ON TS.shohin_id = S.shohin_id
WHERE TS.tenpo_id = '000A';


外部結合

SELECT TS.tenpo_id, TS.tenpo_mei, TS.shohin_id, S.shohin_mei,
S.hanbai_tanka
	FROM TenpoShohin AS TS RIGHT OUTER JOIN Shohin AS S
	ON TS.shohin_id = S.shohin_id;


3つ以上のテーブルを使った結合

CREATE TABLE ZaikoShohin (
  souko_id     CHAR(4)   NOT NULL,  -- 倉庫ID
  shohin_id    CHAR(4)   NOT NULL,  -- 商品ID
  zaiko_suryo  INTEGER   NOT NULL,  -- 在庫数量
  PRIMARY KEY (souko_id, shohin_id) -- 複合主キー
);

BEGIN TRANSACTION;

INSERT INTO ZaikoShohin (souko_id, shohin_id, zaiko_suryo) VALUES ('S001', '0001', 0);

INSERT INTO ZaikoShohin (souko_id, shohin_id, zaiko_suryo) VALUES ('S001', '0002', 120);

INSERT INTO ZaikoShohin (souko_id, shohin_id, zaiko_suryo) VALUES ('S001', '0003', 200);

INSERT INTO ZaikoShohin (souko_id, shohin_id, zaiko_suryo) VALUES ('S001', '0004', 3);

INSERT INTO ZaikoShohin (souko_id, shohin_id, zaiko_suryo) VALUES ('S001', '0005', 0);

INSERT INTO ZaikoShohin (souko_id, shohin_id, zaiko_suryo) VALUES ('S001', '0006', 99);

INSERT INTO ZaikoShohin (souko_id, shohin_id, zaiko_suryo) VALUES ('S001', '0007', 999);

INSERT INTO ZaikoShohin (souko_id, shohin_id, zaiko_suryo) VALUES ('S001', '0008', 200);


INSERT INTO ZaikoShohin (souko_id, shohin_id, zaiko_suryo) VALUES ('S002', '0001', 10);

INSERT INTO ZaikoShohin (souko_id, shohin_id, zaiko_suryo) VALUES ('S002', '0002', 25);

INSERT INTO ZaikoShohin (souko_id, shohin_id, zaiko_suryo) VALUES ('S002', '0003', 34);

INSERT INTO ZaikoShohin (souko_id, shohin_id, zaiko_suryo) VALUES ('S002', '0004', 19);

INSERT INTO ZaikoShohin (souko_id, shohin_id, zaiko_suryo) VALUES ('S002', '0005', 99);

INSERT INTO ZaikoShohin (souko_id, shohin_id, zaiko_suryo) VALUES ('S002', '0006', 0);

INSERT INTO ZaikoShohin (souko_id, shohin_id, zaiko_suryo) VALUES ('S002', '0007', 0);

INSERT INTO ZaikoShohin (souko_id, shohin_id, zaiko_suryo) VALUES ('S002', '0008', 18);

COMMIT;

7-14

SELECT TS.tenpo_id, TS.tenpo_mei, TS.shohin_id, S.shohin_mei, S.hanbai_tanka, ZS.zaiko_suryo
	FROM TenpoShohin AS TS INNER JOIN Shohin AS S
	ON TS.shohin_id = S.shohin_id
		INNER JOIN ZaikoShohin AS ZS
			ON TS.shohin_id = ZS.shohin_id
WHERE ZS.souko_id = 'S001';


演習問題7-2


SELECT TS.tenpo_id, TS.tenpo_mei, TS.shohin_id, S.shohin_mei, S.hanbai_tanka, 
	CASE WHEN tenpo_id  IS NULL THEN '不明'
	ELSE tenpo_id
  	END AS tenpo_id,
	
	CASE WHEN tenpo_mei  IS NULL THEN '不明'
	ELSE tenpo_mei
  	END AS tenpo_mei
 
	FROM TenpoShohin AS TS RIGHT OUTER JOIN Shohin AS S
	ON TS.shohin_id = S.shohin_id;


SELECT COALESCE (TS.tenpo_id, '不明') AS tenpo_id,
	COALESCE (TS.tenpo_mei, '不明') AS tenpo_mei,
	S.shohin_id,
	S.shohin_mei,
	S.hanbai_tanka
FROM TenpoShohin TS RIGHT OUTER JOIN Shohin S
ON TS.shohin_id = S.shohin_id

ORDER BY tenpo_id;



























