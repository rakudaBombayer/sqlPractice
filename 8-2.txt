GROUPING　演算子

8-11
SELECT '合計' AS shohin_bunrui, SUM(hanbai_tanka)
      FROM Shohin
UNION ALL

SELECT shohin_bunrui, SUM(hanbai_tanka)
      FROM Shohin
GROUP BY shohin_bunrui;

8-12
SELECT shohin_bunrui, SUM(hanbai_tanka) AS sum_tanka
	FROM Shohin
	GROUP BY ROLLUP(shohin_bunrui);

8-14
SELECT shohin_bunrui, torokubi, SUM(hanbai_tanka) AS sum_tanka
	FROM Shohin
GROUP BY ROLLUP(shohin_bunrui, torokubi);

8-16
SELECT CASE WHEN GROUPING(shohin_bunrui) = 1
	    THEN '商品分類 合計'
	    ELSE shohin_bunrui END AS shohin_bunrui,
	    CASE WHEN GROUPING(torokubi) = 1
		 THEN '登録日 合計'
	         ELSE CAST (torokubi AS VARCHAR(16)) END AS torokubi,
	    SUM(hanbai_tanka) AS sum_tanka
	FROM Shohin
GROUP BY ROLLUP(shohin_bunrui, torokubi);

8-17
SELECT CASE WHEN GROUPING(shohin_bunrui) = 1
	    THEN '商品分類 合計'
	    ELSE shohin_bunrui END AS shohin_bunrui,
	    CASE WHEN GROUPING(torokubi) = 1
		 THEN '登録日 合計'
	         ELSE CAST (torokubi AS VARCHAR(16)) END AS torokubi,
	    SUM(hanbai_tanka) AS sum_tanka
FROM Shohin
GROUP BY CUBE(shohin_bunrui, torokubi);


8-18
SELECT CASE WHEN GROUPING(shohin_bunrui) = 1
	    THEN '商品分類 合計'
	    ELSE shohin_bunrui END AS shohin_bunrui,
	    CASE WHEN GROUPING(torokubi) = 1
		 THEN '登録日 合計'
	         ELSE CAST (torokubi AS VARCHAR(16)) END AS torokubi,
	    SUM(hanbai_tanka) AS sum_tanka
    FROM Shohin
GROUP BY GROUPING SETS (shohin_bunrui, torokubi);

































