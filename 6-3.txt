CASE式


SELECT shohin_mei,
  CASE 
    WHEN shohin_bunrui = '衣服' THEN 'A:' || shohin_bunrui
    WHEN shohin_bunrui = '事務用品' THEN 'B:' || shohin_bunrui
    WHEN shohin_bunrui = 'キッチン用品' THEN 'C:' || shohin_bunrui
    ELSE NULL
  END AS abc_shohin_bunrui
FROM Shohin;


SELECT shohin_bunrui,
	SUM(hanbai_tanka) AS sum_tanka
FROM Shohin
GROUP BY shohin_bunrui;


SELECT 
	SUM(CASE WHEN shohin_bunrui = '衣服' THEN hanbai_tanka ELSE 0 END) AS sum_tanka_ihuku,

	SUM(CASE WHEN shohin_bunrui = 'キッチン用品' THEN hanbai_tanka ELSE 0 END) AS sum_tanka_kitchen,

	SUM(CASE WHEN shohin_bunrui = '事務用品' THEN hanbai_tanka ELSE 0 END) AS sum_tanka_jimu


FROM Shohin;


演習問題6-2

SELECT

  COUNT(CASE WHEN hanbai_tanka <= 1000 THEN 1 ELSE NULL END) AS low_price_count,
  COUNT(CASE WHEN hanbai_tanka BETWEEN 1001 AND 3000 THEN 1 ELSE NULL END) AS mid_price_count,
  COUNT(CASE WHEN hanbai_tanka >= 3001 THEN 1 ELSE NULL END) AS high_price_count

FROM Shohin;

